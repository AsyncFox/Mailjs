class Mailjs{constructor(){this.baseUrl="https://api.mail.tm",this.token="",this.id="",this.address=""}async register(s,t){const e={address:s,password:t};return this.send_("/accounts","POST",e)}async login(s,t){const e={address:s,password:t},a=await this.send_("/token","POST",e);return a.status&&(this.token=a.data.token,this.id=a.data.id),a}async me(){return this.send_("/me")}async getAccount(s){return this.send_("/accounts/"+s)}async deleteAccount(s){return this.send_("/accounts/"+s,"DELETE")}async deleteMe(){return this.deleteAccount(this.id)}async getDomains(){return this.send_("/domains?page=1")}async getDomain(s){return this.send_("/domains/"+s)}async listMessages(s=1){return this.send_(`/messages?page=${s}`)}async getMessage(s){return this.send_("/messages/"+s)}async deleteMessage(s){return this.send_("/messages/"+s,"DELETE")}async makeSeenTrue(s){return this.send_("/messages/"+s,"PATCH",{seen:!0})}async getSource(s){return this.send_("/sources/"+s)}async createOneAccount(){let s=this.makeHash_(5),t=await this.getDomains();if(!t.status)return t;const e=`${s}@${t=t.data[0].domain}`,a=this.makeHash_(8);let n=await this.register(e,a);if(!n.status)return n;n=n.data;let r=await this.login(e,a);return r.status?(r=r.data,{status:!0,data:{username:e,password:a}}):r}makeHash_(s){return Array.apply(0,Array(s)).map(function(){return(s="abcdefghijklmnopqrstuvwxyz0123456789").charAt(Math.floor(Math.random()*s.length));var s}).join("")}async send_(s,t="GET",e){const a={method:t,headers:{accept:"application/json",authorization:`Bearer ${this.token}`}};if("POST"===t||"PATCH"===t){const s="PATCH"===t?"merge-patch+json":"json";a.headers["content-type"]=`application/${s}`,a.body=JSON.stringify(e)}const n=await fetch(this.baseUrl+s,a);let r;const i=n.headers.get("content-type");return r=i&&i.startsWith("application/json")?await n.json():await n.text(),{status:n.ok,message:n.ok?"ok":r.message,data:r}}}
